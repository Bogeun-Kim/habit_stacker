{% extends 'habit_stacker/base.html' %}

{% block extra_head %}
{% load static %}
<link rel="stylesheet" href="{% static 'css/joined_challenge_page.css' %}">
{% endblock %}

{% block main_area %}
    <!-- Page content-->
    <div id="main-container" class="container px-4 px-lg-5 mt-5">
        <div class="row">
            <div class="col-lg-4-wider">
                <!-- Post content-->
                <article class="image-container-article">
                    <!-- Preview image figure-->
                    <figure class="mb-4 img-container">
                        {% if challenge.image %}
                            <img class="img-fluid rounded" src="{{ challenge.image.url }}" alt="..." />
                        {% else %}
                            <img class="img-fluid rounded" src="https://dummyimage.com/700x467/ced4da/6c757d.jpg" alt="..." />
                        {% endif %}
                    </figure>
                </article>
            </div>
            <div class="col-lg-8-narrower">
                <!-- Card Navigation -->
                <div class="card">
                    <div class="card-header">
                        <ul class="nav nav-tabs card-header-tabs" id="myTab" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active" id="overview-tab" data-bs-toggle="tab" data-bs-target="#overview" type="button" role="tab" aria-controls="overview" aria-selected="true">챌린지 소개</button>
                            </li>
                        </ul>
                        <!-- Post content-->
                    <section class="mb-5">
                        <div class="tab-content" id="myTabContent">
                            <div class="tab-pane fade show active" id="overview" role="tabpanel" aria-labelledby="overview-tab">
                                <h5 class="card-title fw-bolder">Overview Tab</h5>
                                <p class="card-text">기본정보 : {{ challenge.description }}</p>
                                <p class="card-text">카테고리 : {{ challenge.category }}</p>
                                <p class="card-text">start date : {{ challenge.created_at|date:"Y-m-d" }}</p>
                                <p class="card-text">인증샷 예시 : </p>
                                {% if challenge.authentication_image %}
                                    <img class="img-fluid rounded" src="{{ challenge.authentication_image.url }}" style="width: auto; height: 200px;" alt="..."/>
                                {% else %}
                                    <img class="img-fluid rounded" src="https://dummyimage.com/300x200/dee2e6/6c757d.jpg" alt="..." />
                                {% endif %}
                                <p class="card-text">챌린지 진행 시 꼭 확인해주세요! : {{ challenge.note }}</p>
                            </div>

                            {% comment %} <div class="tab-pane fade" id="auth1" role="tabpanel" aria-labelledby="auth1-tab">
                                <h5 class="card-title fw-bolder">나의 인증 현황</h5>
                                <div id="my-authentication-images" class="row">
                                    <!-- 내 인증 사진들이 여기에 동적으로 추가됩니다 -->
                                </div>
                            </div>
                            <div class="tab-pane fade" id="auth2" role="tabpanel" aria-labelledby="auth2-tab">
                                <h5 class="card-title fw-bolder">Authentication Tab</h5>
                                <div id="authentication-images" class="row">
                                    <!-- 인증 사진들이 여기에 동적으로 추가됩니다 -->
                                </div>
                            </div> {% endcomment %}
                        </div>
                    </section>
                    </div>
                </div>
            </div>
        <!-- 새로운 드롭다운 메뉴 추가 -->
        <div class="row mt-5">
            <div class="col-12">
                <div class="btn-group">
                    <button type="button" class="btn btn-secondary dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <span id="currentSelection">다른 사람들의 인증 현황</span>
                    </button>
                    <div class="dropdown-menu">
                        <a class="dropdown-item" id="dropdown-item-authentication" href="#" data-value="others">다른 사람들의 인증 현황</a>
                        <a class="dropdown-item" id="dropdown-item-authentication" href="#" data-value="mine">나의 인증 현황</a>
                    </div>
                </div>
            </div>
        </div>

        <!-- 인증 이미지를 표시할 컨테이너 -->
        <div id="authenticationImagesContainer" class="row mt-3">
            <!-- 인증 이미지들이 여기에 동적으로 추가됩니다 -->
        </div>
    </div>
    {% endblock %}
    {% block extra_scripts %}
    {% load static %}
    <script>
        var redirect_url = "{% url 'authenticate_challenge' challenge_id=challenge.id user_id=0 index=0 %}";
        var challengeId = "{{ challenge.id }}";  // Django 템플릿 변수 사용
        var main_page_url = "{% url 'main_page' %}";
        var join_challenge_url = "{% url 'join_challenge' challenge.id %}";
        var login_url = "{% url 'login' %}";
    </script>
    <script src="{% static 'js/joined_challenge_page.js' %}"></script>
    {% endblock %}